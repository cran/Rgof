<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>R Package Rgof</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">R Package Rgof</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(Rgof)</span></code></pre></div>
<p>The package <em>Rgof</em> brings together a number of routines for
the goodness-of-fit problem for univariate data. We have a data set x,
and we want to test whether it was generated by the probability
distribution F.</p>
<p>The highlights of this package are:</p>
<ul>
<li>it runs a large number of different tests simultaneously.<br />
</li>
<li>it works for continuous and for discrete (aka histogram) data.<br />
</li>
<li>it allows for parameter estimation.<br />
</li>
<li>it uses Rcpp and parallel programming to be very fast.<br />
</li>
<li>it includes routines that make it very easy to estimate the power of
the different tests for specific situations.<br />
</li>
<li>it allows for the possibility that the sample size was a draw from a
Poisson random variable.<br />
</li>
<li>it allows the user to add more tests.<br />
</li>
<li>it includes a routine to draw the usual power graph.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span></code></pre></div>
<p><strong>Note</strong> all runs of the test routine are done with
<em>B=1000</em> and all runs of the power routines with arguments
<em>B=c(500, 500), maxProcessor = 2</em> in order to pass
<em>devtools::check()</em>.</p>
<div id="the-methods" class="section level2">
<h2>The Methods</h2>
<ul>
<li><strong>Continuous Data</strong></li>
</ul>
<ol style="list-style-type: decimal">
<li>Kolmogorov Smirnov (KS) <span class="citation">(Massey 1951)</span>,
<span class="citation">(Kolmogorov 1933)</span>, <span class="citation">(Smirnov 1948)</span></li>
<li>Kuiper (K) <span class="citation">(Kuiper 1960)</span></li>
<li>Anderson-Darling (AD) <span class="citation">(Anderson and Darling
1952)</span>, <span class="citation">(Anderson and Darling
1954)</span></li>
<li>Cramer-vonMises (CvM) <span class="citation">(Anderson
1962)</span><br />
</li>
<li>Wilson (W)<br />
</li>
<li>Zhang’s methods (ZA, ZK, ZC) <span class="citation">(Zhang
2002)</span><br />
</li>
<li>Wasserstein p=1 (Wassp1) <span class="citation">(E del Barrio
1999)</span></li>
</ol>
<p>For all of these tests the distribution of the test statistic under
the null hypothesis is found via simulation.</p>
<ol start="8" style="list-style-type: decimal">
<li>Eight variations of chi square tests, using the formulas by Pearson
or based on the likelihood ratio test, bins of equal size or equal
probability and both a large number and a small number of bins, 100 and
10 by default. The p values are found using the usual chi square
approximation to the null distribution. If parameters are estimated this
is done via the method of minimum chi square, see <span class="citation">(Berkson 1980)</span>. In all cases bins are combined
until all of them have an expected count of at least 2.</li>
</ol>
<p>There is a very large literature on chi square tests, the oldest of
the goodness of fit tests. For a survey see <span class="citation">(Rolke and Gutierrez-Gongora 2020)</span>.</p>
<ul>
<li><strong>Discrete (Histogram) Data</strong></li>
</ul>
<p>All the methods above are also implemented for discrete data, taking
advantage of the fact that the number of bins is fixed and does not grow
with the sample size. Therefore the discrete versions of the tests run
generally much faster than the continuous one.</p>
<p>It is worth noting that these discrete versions are based on the
theoretical ideas of the tests and not on the actual formula of
calculation for the continuous case. The test statistics can therefore
be different even when applied to the same data. For example, the
Anderson-Darling test is based on the distance measure</p>
<p><span class="math display">\[A^2=n\int_{-\infty}^{\infty}
\frac{(\hat{F}(x)-F(x))^2}{F(x)(1-F(x))}dF(x) \]</span> where <span class="math inline">\(F\)</span> is the theoretical distribution
function under the null hypothesis and <span class="math inline">\(\hat{F}\)</span> is the empirical distribution
function. In the case of continuous data it can be shown that</p>
<p><span class="math display">\[A^2=-n-\frac1n\sum_{i=1}^n
(2i-1)\left(\log F(x_i) +\log[1-F(x_{n+1-i})\right)\]</span> However,
for discrete data we have</p>
<p><span class="math display">\[A^2=n\sum_{i=1}^k
\frac{(\hat{F}(x_i)-F(x_i))^2}{F(x_i)(1-F(x_i))}\left(F(x_i)-F(x_{i-1}\right)\]</span></p>
<p>with <span class="math inline">\(F(x_0)=0\)</span>.</p>
<p>In the continuous case <span class="math inline">\(\hat{F}\)</span>
is a step function but <span class="math inline">\(F\)</span> is
continuous, and therefore <span class="math inline">\(A^2&gt;0\)</span>.
In the discrete case however<span class="math inline">\(A^2=0\)</span>
is possible. This shows that the two cases are fundamentally
different.</p>
<p>As for continuous data null distributions are found using simulation.
In fact in the case of discrete data none of the tests has a known
distribution for the test statistic under the null hypothesis.</p>
<ol start="8" style="list-style-type: decimal">
<li>Four variations of chi square tests, using the formulas by Pearson
or based on the likelihood ratio test and both a large number and a
small number of bins. Again the routine combines bins until all have
expected counts greater than 2, and the chi square approximation is used
to find p values.</li>
</ol>
<p>These methods can be used for both discrete and histogram data. The
main difference between these two is that discrete data has (a
countable) number of possible values whereas histogram data has possible
ranges of values (the bins). The only method directly affected by this
difference is Wassp1, which requires actual values. All other methods
ignore the <em>vals</em> argument.</p>
</div>
<div id="testing" class="section level2">
<h2>Testing</h2>
<div id="discrete-histogram-datamodel" class="section level3">
<h3>Discrete (Histogram) Data/Model</h3>
<div id="simple-null-hypothesis" class="section level4">
<h4>Simple Null Hypothesis</h4>
<p>We generate a data set of size 1000 from a Binomial distribution with
n=20 and success probability 0.5, and then test <span class="math inline">\(H_0:F=Bin(20, 0.5)\)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>vals<span class="ot">=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">20</span> <span class="co">#possible values of random variable</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>pnull<span class="ot">=</span><span class="cf">function</span>()  <span class="fu">pbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">20</span>, <span class="fl">0.5</span>)  <span class="co"># cumulative distribution function (cdf)</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>rnull <span class="ot">=</span> <span class="cf">function</span>() <span class="fu">table</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>, <span class="fu">rbinom</span>(<span class="dv">1000</span>, <span class="dv">20</span>, <span class="fl">0.5</span>)))<span class="sc">-</span><span class="dv">1</span> </span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co"># generate data under the null hypothesis, make sure that vector of counts has same length as vals, possibly 0.</span></span></code></pre></div>
<ul>
<li><strong>Null Hypothesis is true</strong></li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnull</span>()</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">gof_test_disc</span>(x, pnull, rnull, vals, <span class="at">B=</span><span class="dv">1000</span>, <span class="at">doMethod =</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt; $Statistics</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt;                KS                 K                AD               CvM </span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt;            0.0089            0.0126            0.1329            0.0249 </span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt;                 W                ZA                ZC            Wassp1 </span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt;            2.0453            3.3967          217.2362            0.0346 </span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; chi large Pearson chi small Pearson    chi large LR-m    chi small LR-m </span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt;            1.9080            1.2390            1.9052            1.2310 </span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt; $p.value</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt;                KS                 K                AD               CvM </span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt;            0.9710            0.9830            0.9970            0.9700 </span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt;                 W                ZA                ZC            Wassp1 </span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt;            0.6690            0.7090            0.7120            0.9950 </span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#&gt; chi large Pearson chi small Pearson    chi large LR-m    chi small LR-m </span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt;            0.9995            0.9987            0.9995            0.9987</span></span></code></pre></div>
<ul>
<li><strong>Null Hypothesis is false</strong></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">table</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>, <span class="fu">rbinom</span>(<span class="dv">1000</span>, <span class="dv">20</span>, <span class="fl">0.55</span>)))<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#true p is 0.55, not 0.5</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="fu">gof_test_disc</span>(x, pnull, rnull, vals, <span class="at">B=</span><span class="dv">1000</span>, <span class="at">doMethod =</span> <span class="st">&quot;all&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt;                KS                 K                AD               CvM </span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt;                 0                 0                 0                 0 </span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt;                 W                ZA                ZC            Wassp1 </span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt;                 0                 0                 0                 0 </span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt; chi large Pearson chi small Pearson    chi large LR-m    chi small LR-m </span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt;                 0                 0                 0                 0</span></span></code></pre></div>
<p>Arguments of <em>gof_test_disc</em>:</p>
<ul>
<li><p>x: vector with counts (histogram heights). Should have a number
for each value of vals, possibly 0.</p></li>
<li><p>pnull: function to find values of cumulative distribution
function for each value of vals. Function has no arguments.</p></li>
<li><p>rnull: function to generate data from true density. Function has
no arguments. Function needs to insure that output is a vector with same
length as vals.</p></li>
<li><p>vals: all possible values of discrete random variable, that is
all x with <span class="math inline">\(P(X=x)&gt;0\)</span></p></li>
</ul>
</div>
<div id="random-sample-size" class="section level4">
<h4>Random Sample Size</h4>
<p>In some fields like high energy physics it is common that the sample
size is not fixed but a random variable drawn from a Poisson
distribution with a known rate. Our package easily accomodates that:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>rnull <span class="ot">=</span> <span class="cf">function</span>() <span class="fu">table</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>, <span class="fu">rbinom</span>(<span class="fu">rpois</span>(<span class="dv">1</span>, <span class="dv">650</span>), <span class="dv">20</span>, <span class="fl">0.5</span>)))<span class="sc">-</span><span class="dv">1</span> </span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnull</span>()</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="fu">gof_test_disc</span>(x, pnull, rnull, vals, <span class="at">rate=</span><span class="dv">650</span>, <span class="at">B=</span><span class="dv">1000</span>, <span class="at">doMethod =</span> <span class="st">&quot;all&quot;</span>)<span class="sc">$</span>p.value</span></code></pre></div>
</div>
<div id="composite-null-hypothesis" class="section level4">
<h4>Composite Null Hypothesis</h4>
<p>We generate a data set of size 1000 from a Binomial distribution with
n=20 and success probability p, and then test F=Bin(20, .). p is
estimated from data.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>vals<span class="ot">=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>pnull<span class="ot">=</span><span class="cf">function</span>(<span class="at">p=</span><span class="fl">0.5</span>)  <span class="fu">pbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">20</span>, <span class="fu">ifelse</span>(p<span class="sc">&gt;</span><span class="dv">0</span><span class="sc">&amp;&amp;</span>p<span class="sc">&lt;</span><span class="dv">1</span>, p, <span class="fl">0.5</span>))  </span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>rnull <span class="ot">=</span> <span class="cf">function</span>(<span class="at">p=</span><span class="fl">0.5</span>) <span class="fu">table</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>, <span class="fu">rbinom</span>(<span class="dv">1000</span>, <span class="dv">20</span>, p)))<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>phat <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">20</span><span class="sc">*</span>x)<span class="sc">/</span><span class="fu">sum</span>(x)<span class="sc">/</span><span class="dv">20</span></span></code></pre></div>
<ul>
<li><strong>Null Hypothesis is true</strong></li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">table</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>, <span class="fu">rbinom</span>(<span class="dv">1000</span>, <span class="dv">20</span>, <span class="fl">0.5</span>)))<span class="sc">-</span><span class="dv">1</span>  </span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="fu">gof_test_disc</span>(x, pnull, rnull, vals, <span class="at">phat=</span>phat, <span class="at">B=</span><span class="dv">1000</span>, <span class="at">doMethod =</span> <span class="st">&quot;all&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt;                KS                 K                AD               CvM </span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt;            0.3030            0.1670            0.2080            0.2770 </span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt;                 W                ZA                ZC            Wassp1 </span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt;            0.1450            0.8570            0.4720            0.1680 </span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; chi large Pearson chi small Pearson    chi large LR-m    chi small LR-m </span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt;            0.3779            0.4247            0.4576            0.4512</span></span></code></pre></div>
<ul>
<li><strong>Null Hypothesis is true</strong></li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">table</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>, <span class="fu">rbinom</span>(<span class="dv">1000</span>, <span class="dv">20</span>, <span class="fl">0.55</span>)))<span class="sc">-</span><span class="dv">1</span> </span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co"># p is not 0.5, but data is still from a binomial distribution with n=20</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="fu">gof_test_disc</span>(x, pnull, rnull, vals, <span class="at">phat=</span>phat, <span class="at">B=</span><span class="dv">1000</span>, <span class="at">doMethod =</span> <span class="st">&quot;all&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt;                KS                 K                AD               CvM </span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt;            0.3980            0.6350            0.5150            0.5640 </span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt;                 W                ZA                ZC            Wassp1 </span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt;            0.8550            0.8750            0.6450            0.6310 </span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; chi large Pearson chi small Pearson    chi large LR-m    chi small LR-m </span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt;            0.9295            0.8272            0.9360            0.8316</span></span></code></pre></div>
<ul>
<li><strong>Null Hypothesis is false</strong></li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">table</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">5</span>), <span class="fu">rbinom</span>(<span class="dv">1000-21</span><span class="sc">*</span><span class="dv">5</span>, <span class="dv">20</span>, <span class="fl">0.53</span>))) </span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co"># data has to many small and large values to be from a binomial</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="fu">gof_test_disc</span>(x, pnull, rnull, vals, <span class="at">phat=</span>phat, <span class="at">B=</span><span class="dv">1000</span>, <span class="at">doMethod =</span> <span class="st">&quot;all&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co">#&gt;                KS                 K                AD               CvM </span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co">#&gt;             0.003             0.000             0.000             0.000 </span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co">#&gt;                 W                ZA                ZC            Wassp1 </span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co">#&gt;             0.002             0.000             0.000             0.000 </span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co">#&gt; chi large Pearson chi small Pearson    chi large LR-m    chi small LR-m </span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co">#&gt;             0.000             0.000             0.000             0.000</span></span></code></pre></div>
<p>Arguments of <em>gof_test_disc</em>:</p>
<ul>
<li><p>x: vector with counts. Should have a number for each value in
vals, possibly 0.</p></li>
<li><p>pnull: cumulative distribution function. One argument, a vector
of parameters.</p></li>
<li><p>rnull: function to generate data from distribution. One argument,
a vector of parameters.</p></li>
<li><p>vals: possible values of discrete random variable, that is all x
with <span class="math inline">\(P(X=x)&gt;0\)</span></p></li>
<li><p>phat: function of data to estimate parameter. Data is sole
argument.</p></li>
</ul>
<p>The estimation of the parameter(s) in the case of the chi square
tests is done via the minimum chi square method. The routine uses a
general function minimizer. If there are values of the parameter that
are not possible this can lead to warnings. It is best to put a check
into the pnull function to avoid this issue. As an example the function
pnull above checks that the success probability p is in the interval
<span class="math inline">\((0.1)\)</span>.</p>
</div>
</div>
<div id="histogram-data" class="section level3">
<h3>Histogram Data</h3>
<p>A variant of discrete data sometimes encountered is data given in the
form of a histogram, that is as a set of bins and their counts. The main
distinction is that discrete data has specific values, for example the
non-negative integers for a Poisson distribution, whereas histogram data
has ranges of numbers, the bins. It turns out that, though, that the
only method that requires actual values is Wassp1, and for that method
one can use the midpoint of the intervals.</p>
<p>As an example consider the following case: we have histogram data and
we want to test whether it comes from an exponential rate 1
distribution, truncated to the interval 0-2:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>rnull <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  y <span class="ot">=</span> <span class="fu">rexp</span>(<span class="dv">2500</span>, <span class="dv">1</span>) <span class="co"># Exp(1) data</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  y <span class="ot">=</span> y[y<span class="sc">&lt;</span><span class="dv">2</span>][<span class="dv">1</span><span class="sc">:</span><span class="dv">1500</span>] <span class="co"># 1500 events on 0-2</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  bins <span class="ot">=</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">40</span><span class="sc">/</span><span class="dv">20</span> <span class="co"># binning</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  <span class="fu">hist</span>(y, bins, <span class="at">plot=</span><span class="cn">FALSE</span>)<span class="sc">$</span>counts <span class="co"># find bin counts</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>}</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnull</span>()</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>bins <span class="ot">=</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">40</span><span class="sc">/</span><span class="dv">20</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>vals <span class="ot">=</span> (bins[<span class="sc">-</span><span class="dv">1</span>]<span class="sc">+</span>bins[<span class="sc">-</span><span class="dv">21</span>])<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>pnull <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>   bins <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">40</span><span class="sc">/</span><span class="dv">20</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>   <span class="fu">pexp</span>(bins, <span class="dv">1</span>)<span class="sc">/</span><span class="fu">pexp</span>(<span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>}</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>  </span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="fu">gof_test_disc</span>(x, pnull, rnull, vals, <span class="at">doMethod =</span> <span class="st">&quot;all&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="co">#&gt;                KS                 K                AD               CvM </span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co">#&gt;            0.0292            0.0024            0.0818            0.0910 </span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="co">#&gt;                 W                ZA                ZC            Wassp1 </span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="co">#&gt;            0.3436            0.2030            0.0966            0.1114 </span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a><span class="co">#&gt; chi large Pearson chi small Pearson    chi large LR-m    chi small LR-m </span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a><span class="co">#&gt;            0.2974            0.4811            0.2490            0.4545</span></span></code></pre></div>
</div>
<div id="continuous-data" class="section level3">
<h3>Continuous Data</h3>
<div id="simple-hypothesis" class="section level4">
<h4>Simple Hypothesis</h4>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>pnull <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">pnorm</span>(x)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>qnull <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">qnorm</span>(x)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>rnull <span class="ot">=</span> <span class="cf">function</span>()  <span class="fu">rnorm</span>(<span class="dv">1000</span>)</span></code></pre></div>
<ul>
<li><strong>Null Hypothesis is true</strong></li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">gof_test_cont</span>(x, pnull, rnull, qnull, <span class="at">B=</span><span class="dv">1000</span>, <span class="at">doMethod =</span> <span class="st">&quot;all&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="co">#&gt;               KS                K               AD              CvM </span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co">#&gt;           0.3950           0.3950           0.2880           0.3500 </span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co">#&gt;                W               ZA               ZK               ZC </span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co">#&gt;           0.5800           0.5220           0.2550           0.5800 </span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co">#&gt;           Wassp1 EP large Pearson ES large Pearson EP small Pearson </span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="co">#&gt;           0.2730           0.0816           0.5400           0.1284 </span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="co">#&gt; ES small Pearson    EP large LR-m    ES large LR-m    EP small LR-m </span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="co">#&gt;           0.2447           0.2964           0.4631           0.1332 </span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="co">#&gt;    ES small LR-m </span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="co">#&gt;           0.3068</span></span></code></pre></div>
<ul>
<li><strong>Null Hypothesis is false</strong></li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="fl">0.5</span>) </span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">gof_test_cont</span>(x, pnull, rnull, qnull, <span class="at">B=</span><span class="dv">1000</span>, <span class="at">doMethod =</span> <span class="st">&quot;all&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co">#&gt;               KS                K               AD              CvM </span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co">#&gt;                0                0                0                0 </span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co">#&gt;                W               ZA               ZK               ZC </span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co">#&gt;                0                0                0                0 </span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="co">#&gt;           Wassp1 EP large Pearson ES large Pearson EP small Pearson </span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co">#&gt;                0                0                0                0 </span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co">#&gt; ES small Pearson    EP large LR-m    ES large LR-m    EP small LR-m </span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co">#&gt;                0                0                0                0 </span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co">#&gt;    ES small LR-m </span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co">#&gt;                0</span></span></code></pre></div>
<p>Arguments of <em>gof_test_cont</em>:</p>
<ul>
<li><p>x: data set</p></li>
<li><p>pnull: function to find cdf. Function has one argument, points
where cdf is to be evaluated.</p></li>
<li><p>rnull: function to generate data from density. Function has no
argument.</p></li>
<li><p>qnull: quantile function. Function has one argument, points where
inverse cdf is to be evaluated. If missing Wassp1 method is not
used.</p></li>
</ul>
</div>
<div id="composite-hypothesis---one-parameter" class="section level4">
<h4>Composite Hypothesis - One Parameter</h4>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>pnull <span class="ot">=</span> <span class="cf">function</span>(x, <span class="at">p=</span><span class="dv">0</span>) <span class="fu">pnorm</span>(x, p)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>qnull <span class="ot">=</span> <span class="cf">function</span>(x, <span class="at">p=</span><span class="dv">0</span>) <span class="fu">qnorm</span>(x, p)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>rnull <span class="ot">=</span> <span class="cf">function</span>(p)  <span class="fu">rnorm</span>(<span class="dv">1000</span>, p)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>phat <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(x)</span></code></pre></div>
<ul>
<li><strong>Null Hypothesis is true</strong></li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>) </span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="fu">gof_test_cont</span>(x, pnull, rnull, qnull, <span class="at">phat=</span>phat, <span class="at">B=</span><span class="dv">1000</span>, <span class="at">doMethod =</span> <span class="st">&quot;all&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co">#&gt;               KS                K               AD              CvM </span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co">#&gt;           0.1730           0.1730           0.1870           0.2720 </span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co">#&gt;                W               ZA               ZK               ZC </span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="co">#&gt;           0.2750           0.6030           0.2350           0.5550 </span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="co">#&gt;           Wassp1 EP large Pearson ES large Pearson EP small Pearson </span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="co">#&gt;           0.2170           0.0023           0.0954           0.5176 </span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="co">#&gt; ES small Pearson    EP large LR-m    ES large LR-m    EP small LR-m </span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="co">#&gt;           0.5232           0.0107           0.2085           0.5147 </span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a><span class="co">#&gt;    ES small LR-m </span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a><span class="co">#&gt;           0.5812</span></span></code></pre></div>
<ul>
<li><strong>Null Hypothesis is true</strong></li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="fl">0.5</span>) </span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">gof_test_cont</span>(x, pnull, rnull, qnull, <span class="at">phat=</span>phat)<span class="sc">$</span>p.value</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="co">#&gt;                W               ZK               ZC           Wassp1 </span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co">#&gt;           0.4570           0.1984           0.3268           0.7182 </span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="co">#&gt; EP small Pearson ES small Pearson </span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="co">#&gt;           0.6214           0.6794</span></span></code></pre></div>
<ul>
<li><strong>Null Hypothesis is false</strong></li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="fl">0.5</span>, <span class="dv">2</span>) </span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="fu">gof_test_cont</span>(x, pnull, rnull, qnull, <span class="at">phat=</span>phat, <span class="at">B=</span><span class="dv">1000</span>, <span class="at">doMethod =</span> <span class="st">&quot;all&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co">#&gt;               KS                K               AD              CvM </span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co">#&gt;                0                0                0                0 </span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#&gt;                W               ZA               ZK               ZC </span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co">#&gt;                0                0                0                0 </span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co">#&gt;           Wassp1 EP large Pearson ES large Pearson EP small Pearson </span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co">#&gt;                0                0                0                0 </span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co">#&gt; ES small Pearson    EP large LR-m    ES large LR-m    EP small LR-m </span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co">#&gt;                0                0                0                0 </span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a><span class="co">#&gt;    ES small LR-m </span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co">#&gt;                0</span></span></code></pre></div>
<p>Arguments:</p>
<ul>
<li><p>x: data set</p></li>
<li><p>pnull: function to find cdf. First argument is points to evaluate
function, second argument is parameters.</p></li>
<li><p>rnull: function to generate data from density. Sole argument is
vector of parameters.</p></li>
<li><p>qnull: quantile function. Arguments are same as pnull.</p></li>
<li><p>phat: function to estimate the parameter</p></li>
</ul>
</div>
<div id="composite-hypothesis---multiple-parameters" class="section level4">
<h4>Composite Hypothesis - Multiple Parameters</h4>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>pnull <span class="ot">=</span> <span class="cf">function</span>(x, <span class="at">p=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="fu">pnorm</span>(x, p[<span class="dv">1</span>], <span class="fu">ifelse</span>(p[<span class="dv">2</span>]<span class="sc">&gt;</span><span class="dv">0</span>, p[<span class="dv">2</span>], <span class="fl">0.001</span>))</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>qnull <span class="ot">=</span> <span class="cf">function</span>(x, <span class="at">p=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="fu">qnorm</span>(x, p[<span class="dv">1</span>], <span class="fu">ifelse</span>(p[<span class="dv">2</span>]<span class="sc">&gt;</span><span class="dv">0</span>, p[<span class="dv">2</span>], <span class="fl">0.001</span>))</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>rnull <span class="ot">=</span> <span class="cf">function</span>(<span class="at">p=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))  <span class="fu">rnorm</span>(<span class="dv">1000</span>, p[<span class="dv">1</span>], <span class="fu">ifelse</span>(p[<span class="dv">2</span>]<span class="sc">&gt;</span><span class="dv">0</span>, p[<span class="dv">2</span>], <span class="fl">0.001</span>))</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>phat <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="fu">mean</span>(x), <span class="fu">sd</span>(x))</span></code></pre></div>
<ul>
<li><strong>Null Hypothesis is true</strong></li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>) </span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="fu">gof_test_cont</span>(x, pnull, rnull, qnull, <span class="at">phat=</span>phat, <span class="at">B=</span><span class="dv">1000</span>, <span class="at">doMethod =</span> <span class="st">&quot;all&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="co">#&gt;               KS                K               AD              CvM </span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="co">#&gt;           0.4110           0.4110           0.3760           0.3950 </span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="co">#&gt;                W               ZA               ZK               ZC </span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="co">#&gt;           0.4100           0.3400           0.2870           0.3440 </span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="co">#&gt;           Wassp1 EP large Pearson ES large Pearson EP small Pearson </span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="co">#&gt;           0.3450           0.5576           0.3154           0.5036 </span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a><span class="co">#&gt; ES small Pearson    EP large LR-m    ES large LR-m    EP small LR-m </span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a><span class="co">#&gt;           0.7751           0.7432           0.2360           0.5022 </span></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a><span class="co">#&gt;    ES small LR-m </span></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a><span class="co">#&gt;           0.7735</span></span></code></pre></div>
<ul>
<li><strong>Null Hypothesis is true</strong></li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="fl">0.5</span>) </span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="fu">gof_test_cont</span>(x, pnull, rnull, qnull, <span class="at">phat=</span>phat, <span class="at">B=</span><span class="dv">1000</span>, <span class="at">doMethod =</span> <span class="st">&quot;all&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="co">#&gt;               KS                K               AD              CvM </span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="co">#&gt;           0.8110           0.8110           0.5690           0.7840 </span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="co">#&gt;                W               ZA               ZK               ZC </span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="co">#&gt;           0.8210           0.2720           0.4180           0.2790 </span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="co">#&gt;           Wassp1 EP large Pearson ES large Pearson EP small Pearson </span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="co">#&gt;           0.5220           0.1061           0.3877           0.8568 </span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a><span class="co">#&gt; ES small Pearson    EP large LR-m    ES large LR-m    EP small LR-m </span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="co">#&gt;           0.4186           0.2579           0.5467           0.8541 </span></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a><span class="co">#&gt;    ES small LR-m </span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a><span class="co">#&gt;           0.4325</span></span></code></pre></div>
<ul>
<li><strong>Null Hypothesis is true</strong></li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="fl">0.5</span>, <span class="dv">2</span>) </span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="fu">gof_test_cont</span>(x, pnull, rnull, qnull, <span class="at">phat=</span>phat, <span class="at">B=</span><span class="dv">1000</span>, <span class="at">doMethod =</span> <span class="st">&quot;all&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="co">#&gt;               KS                K               AD              CvM </span></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="co">#&gt;           0.4060           0.4060           0.3100           0.3640 </span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="co">#&gt;                W               ZA               ZK               ZC </span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="co">#&gt;           0.3890           0.0240           0.0790           0.0540 </span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a><span class="co">#&gt;           Wassp1 EP large Pearson ES large Pearson EP small Pearson </span></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a><span class="co">#&gt;           0.2130           0.5339           0.5418           0.1156 </span></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="co">#&gt; ES small Pearson    EP large LR-m    ES large LR-m    EP small LR-m </span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a><span class="co">#&gt;           0.2940           0.6369           0.4703           0.1285 </span></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a><span class="co">#&gt;    ES small LR-m </span></span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a><span class="co">#&gt;           0.3030</span></span></code></pre></div>
<ul>
<li><strong>Null Hypothesis is false</strong></li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rt</span>(<span class="dv">1000</span>, <span class="dv">2</span>) </span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="fu">gof_test_cont</span>(x, pnull, rnull, qnull, <span class="at">phat=</span>phat, <span class="at">B=</span><span class="dv">1000</span>, <span class="at">doMethod =</span> <span class="st">&quot;all&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="co">#&gt;               KS                K               AD              CvM </span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a><span class="co">#&gt;                0                0                0                0 </span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="co">#&gt;                W               ZA               ZK               ZC </span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="co">#&gt;                0                0                0                0 </span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="co">#&gt;           Wassp1 EP large Pearson ES large Pearson EP small Pearson </span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a><span class="co">#&gt;                0                0                0                0 </span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="co">#&gt; ES small Pearson    EP large LR-m    ES large LR-m    EP small LR-m </span></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a><span class="co">#&gt;                0                0                0                0 </span></span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a><span class="co">#&gt;    ES small LR-m </span></span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a><span class="co">#&gt;                0</span></span></code></pre></div>
<p>Arguments: Same as for a single parameter.</p>
</div>
</div>
</div>
<div id="power-estimation" class="section level2">
<h2>Power Estimation</h2>
<div id="discrete-datamodel" class="section level3">
<h3>Discrete Data/Model</h3>
<div id="simple-null-hypothesis-1" class="section level4">
<h4>Simple Null Hypothesis</h4>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>vals <span class="ot">=</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>pnull <span class="ot">=</span> <span class="cf">function</span>() <span class="fu">pbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.5</span>)</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>rnull <span class="ot">=</span><span class="cf">function</span> () <span class="fu">table</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, <span class="fu">rbinom</span>(<span class="dv">100</span>, <span class="dv">10</span>, <span class="fl">0.5</span>)))<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>ralt <span class="ot">=</span><span class="cf">function</span> (p) <span class="fu">table</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, <span class="fu">rbinom</span>(<span class="dv">100</span>, <span class="dv">10</span>, p)))<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>P<span class="ot">=</span><span class="fu">gof_power_disc</span>(pnull, rnull, vals, ralt, </span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>  <span class="at">param_alt=</span><span class="fu">seq</span>(<span class="fl">0.5</span>, <span class="fl">0.6</span>, <span class="fl">0.01</span>),  <span class="at">B=</span><span class="fu">c</span>(<span class="dv">500</span>, <span class="dv">500</span>), <span class="at">nbins=</span><span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">5</span>))</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a><span class="fu">plot_power</span>(P, <span class="st">&quot;p&quot;</span>, <span class="at">Smooth=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>In all cases the arguments vals, pnull and rnull are the same as for
the testing routines. In addition we now have</p>
<ul>
<li><p>ralt: a routine with one parameter that generates data under some
alternative hypothesis.</p></li>
<li><p>param_alt: values to be passed to ralt. This allows the
calculation of the power for many different values.</p></li>
<li><p>B=c(1000, 1000) the first number is the number of simulation runs
for power estimation and the second the number of runs to be used to
find the null distribution.</p></li>
</ul>
</div>
<div id="composite-null-hypothesis-1" class="section level4">
<h4>Composite Null Hypothesis</h4>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>vals <span class="ot">=</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>pnull <span class="ot">=</span> <span class="cf">function</span>(p) <span class="fu">pbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">10</span>, p)</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>rnull <span class="ot">=</span> <span class="cf">function</span> (p) <span class="fu">table</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, <span class="fu">rbinom</span>(<span class="dv">100</span>, <span class="dv">10</span>, p)))<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>phat <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span><span class="sc">*</span>x)<span class="sc">/</span><span class="dv">1000</span></span></code></pre></div>
<ul>
<li><strong>Null Hypothesis is true</strong></li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>ralt <span class="ot">=</span><span class="cf">function</span> (p) <span class="fu">table</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, <span class="fu">rbinom</span>(<span class="dv">100</span>, <span class="dv">10</span>, p)))<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="fu">gof_power_disc</span>(pnull, rnull, vals, ralt, <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.6</span>), phat,</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>        <span class="at">B=</span><span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">200</span>), <span class="at">nbins=</span><span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">5</span>), <span class="at">maxProcessors =</span> <span class="dv">2</span>)</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="co">#&gt;       KS    K   AD  CvM    W   ZA   ZC Wassp1 chi large Pearson</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a><span class="co">#&gt; 0.5 0.06 0.06 0.04 0.08 0.05 0.05 0.04   0.06              0.02</span></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a><span class="co">#&gt; 0.6 0.05 0.06 0.07 0.07 0.03 0.05 0.00   0.06              0.03</span></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a><span class="co">#&gt;     chi small Pearson chi large LR-m chi small LR-m</span></span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a><span class="co">#&gt; 0.5              0.06           0.02           0.06</span></span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a><span class="co">#&gt; 0.6              0.02           0.03           0.02</span></span></code></pre></div>
<p>Note that power estimation in the case of a composite hypothesis (aka
with parameters estimated) is much slower than the simple hypothesis
case.</p>
<ul>
<li><strong>Null Hypothesis is false</strong></li>
</ul>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>ralt <span class="ot">=</span><span class="cf">function</span> (p) <span class="fu">table</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">2</span>), <span class="fu">rbinom</span>(<span class="dv">100</span>, <span class="dv">10</span>, p)))</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a><span class="fu">gof_power_disc</span>(pnull, rnull, vals, ralt, <span class="fl">0.5</span>, phat,</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>        <span class="at">B=</span><span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">200</span>), <span class="at">nbins=</span><span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">5</span>), <span class="at">maxProcessors =</span> <span class="dv">2</span>)</span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a><span class="co">#&gt;                KS                 K                AD               CvM </span></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a><span class="co">#&gt;              1.00              1.00              1.00              1.00 </span></span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a><span class="co">#&gt;                 W                ZA                ZC            Wassp1 </span></span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a><span class="co">#&gt;              0.63              1.00              0.00              1.00 </span></span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a><span class="co">#&gt; chi large Pearson chi small Pearson    chi large LR-m    chi small LR-m </span></span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a><span class="co">#&gt;              0.23              0.09              0.17              0.10</span></span></code></pre></div>
</div>
</div>
<div id="continuous-datamodel" class="section level3">
<h3>Continuous Data/Model</h3>
<div id="simple-null-hypothesis-2" class="section level4">
<h4>Simple Null Hypothesis</h4>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>pnull <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">pnorm</span>(x)</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>qnull <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">qnorm</span>(x)</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>rnull <span class="ot">=</span> <span class="cf">function</span>() <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>ralt <span class="ot">=</span> <span class="cf">function</span>(<span class="at">mu=</span><span class="dv">0</span>) <span class="fu">rnorm</span>(<span class="dv">100</span>, mu)</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a><span class="fu">gof_power_cont</span>(pnull, rnull, qnull, ralt, <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">B=</span><span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">200</span>))</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a><span class="co">#&gt;     KS    K   AD  CvM    W   ZA   ZK   ZC Wassp1 EP large Pearson</span></span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a><span class="co">#&gt; 0 0.02 0.02 0.04 0.04 0.04 0.07 0.06 0.05   0.04             0.07</span></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a><span class="co">#&gt; 1 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00   1.00             1.00</span></span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a><span class="co">#&gt;   ES large Pearson EP small Pearson ES small Pearson EP large LR-m</span></span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a><span class="co">#&gt; 0             0.12             0.12             0.05          0.03</span></span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a><span class="co">#&gt; 1             1.00             1.00             1.00          1.00</span></span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a><span class="co">#&gt;   ES large LR-m EP small LR-m ES small LR-m</span></span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a><span class="co">#&gt; 0          0.06          0.06          0.05</span></span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a><span class="co">#&gt; 1          1.00          1.00          1.00</span></span></code></pre></div>
</div>
<div id="composite-null-hypothesis-2" class="section level4">
<h4>Composite Null Hypothesis</h4>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>pnull <span class="ot">=</span> <span class="cf">function</span>(x, <span class="at">p=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="fu">pnorm</span>(x, p[<span class="dv">1</span>], <span class="fu">ifelse</span>(p[<span class="dv">2</span>]<span class="sc">&gt;</span><span class="dv">0</span>, p[<span class="dv">2</span>], <span class="fl">0.01</span>))</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>qnull <span class="ot">=</span> <span class="cf">function</span>(x, <span class="at">p=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="fu">qnorm</span>(x, p[<span class="dv">1</span>], <span class="fu">ifelse</span>(p[<span class="dv">2</span>]<span class="sc">&gt;</span><span class="dv">0</span>, p[<span class="dv">2</span>], <span class="fl">0.01</span>))</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>rnull <span class="ot">=</span> <span class="cf">function</span>(<span class="at">p=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="fu">rnorm</span>(<span class="dv">500</span>, p[<span class="dv">1</span>], p[<span class="dv">2</span>])</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>ralt <span class="ot">=</span> <span class="cf">function</span>(<span class="at">mu=</span><span class="dv">0</span>) <span class="fu">rnorm</span>(<span class="dv">100</span>, mu)</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>phat <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="fu">mean</span>(x), <span class="fu">sd</span>(x))</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a><span class="fu">gof_power_cont</span>(pnull, rnull, qnull, ralt, <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), phat, <span class="at">B=</span><span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">200</span>),</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>               <span class="at">maxProcessor=</span><span class="dv">2</span>)</span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a><span class="co">#&gt;     KS    K   AD  CvM    W   ZA   ZK   ZC Wassp1 EP large Pearson</span></span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a><span class="co">#&gt; 0 0.94 0.90 0.08 0.09 0.09 0.64 0.01 0.01      1             0.06</span></span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a><span class="co">#&gt; 1 0.97 0.89 0.09 0.06 0.06 0.60 0.02 0.03      1             0.04</span></span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a><span class="co">#&gt;   ES large Pearson EP small Pearson ES small Pearson EP large LR-m</span></span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a><span class="co">#&gt; 0             0.03             0.09             0.04          0.04</span></span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a><span class="co">#&gt; 1             0.04             0.08             0.04          0.02</span></span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a><span class="co">#&gt;   ES large LR-m EP small LR-m ES small LR-m</span></span>
<span id="cb29-15"><a href="#cb29-15" tabindex="-1"></a><span class="co">#&gt; 0          0.04          0.06          0.05</span></span>
<span id="cb29-16"><a href="#cb29-16" tabindex="-1"></a><span class="co">#&gt; 1          0.03          0.06          0.04</span></span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>ralt <span class="ot">=</span> <span class="cf">function</span>(<span class="at">df=</span><span class="dv">1</span>) {</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="co"># t distribution truncated at +- 5  </span></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">rt</span>(<span class="dv">1000</span>, df)</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>  x<span class="ot">=</span>x[<span class="fu">abs</span>(x)<span class="sc">&lt;</span><span class="dv">5</span>]</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>  x[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>]</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>}  </span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a><span class="fu">gof_power_cont</span>(pnull, rnull, qnull, ralt, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">50</span>), phat, <span class="at">Range=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>), <span class="at">B=</span><span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">200</span>), <span class="at">maxProcessor=</span><span class="dv">2</span>)</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a><span class="co">#&gt;      KS    K   AD  CvM    W   ZA   ZK   ZC Wassp1 EP large Pearson</span></span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a><span class="co">#&gt; 2  1.00 1.00 0.63 0.61 0.62 0.96 0.27 0.17      1             0.19</span></span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a><span class="co">#&gt; 50 0.96 0.94 0.04 0.06 0.04 0.69 0.00 0.02      1             0.09</span></span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a><span class="co">#&gt;    ES large Pearson EP small Pearson ES small Pearson EP large LR-m</span></span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a><span class="co">#&gt; 2              0.28             0.24             0.36          0.10</span></span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a><span class="co">#&gt; 50             0.00             0.11             0.03          0.03</span></span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a><span class="co">#&gt;    ES large LR-m EP small LR-m ES small LR-m</span></span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a><span class="co">#&gt; 2           0.24          0.21          0.37</span></span>
<span id="cb30-16"><a href="#cb30-16" tabindex="-1"></a><span class="co">#&gt; 50          0.01          0.07          0.03</span></span></code></pre></div>
</div>
</div>
<div id="running-other-tests" class="section level3">
<h3>Running other tests</h3>
<p>Its is very easy for a user to add other goodness-of-fit tests to the
package. This can be done by editing the routines
<strong>TS_cont</strong> and/or <strong>TS_disc</strong>, which are
located in the folder <em>inst/examples</em> in the Rgof library folder.
Or a user can write their own version of these files.</p>
<p><strong>Example</strong></p>
<p>Say we wish to use a test that is a variant of the Cramer-vonMises
test, using the integrated absolute difference of the empirical and the
theoretical distribution function:</p>
<p><span class="math display">\[\int_{-\infty}^{\infty} \vert F(x) -
\hat{F}(x) \vert dF(x)\]</span> For continuous data we have the
routine</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>newTS_cont <span class="ot">=</span> <span class="cf">function</span>(x, Fx, param, qnull) {</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>   Fx<span class="ot">=</span><span class="fu">sort</span>(Fx)</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>   n<span class="ot">=</span><span class="fu">length</span>(x)</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>   out <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">abs</span>( (<span class="dv">2</span><span class="sc">*</span><span class="dv">1</span><span class="sc">:</span>n<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span><span class="sc">/</span>n<span class="sc">-</span>Fx ))</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>   <span class="fu">names</span>(out) <span class="ot">=</span> <span class="st">&quot;CvM alt&quot;</span></span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>   out</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>}</span></code></pre></div>
<p>This routine has to have four arguments x, Fx, param and qnull, just
like TS_cont. Note that the return object has to be a
<strong>named</strong> vector. Also, the arguments param and qnull are
likely not needed for the calculation of the new test statistic but need
to be present for consistency reasons.</p>
<p>Then we can run this test with</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>pnull <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">punif</span>(x)</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>qnull <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">qunif</span>(x)</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>rnull <span class="ot">=</span> <span class="cf">function</span>() <span class="fu">runif</span>(<span class="dv">500</span>)</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnull</span>()</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>Rgof<span class="sc">::</span><span class="fu">gof_test_cont</span>(x, pnull, rnull, qnull, <span class="at">TS=</span>newTS_cont)</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a><span class="co">#&gt; $Statistics</span></span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a><span class="co">#&gt; CvM alt </span></span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a><span class="co">#&gt;  6.9863 </span></span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a><span class="co">#&gt; $p.value</span></span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a><span class="co">#&gt; CvM alt </span></span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a><span class="co">#&gt;  0.3946</span></span></code></pre></div>
<p>Say we want to find the power of this test when the true distribution
is a linear:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>ralt <span class="ot">=</span> <span class="cf">function</span>(slope) {</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>  <span class="cf">if</span>(slope<span class="sc">==</span><span class="dv">0</span>) y<span class="ot">=</span><span class="fu">runif</span>(<span class="dv">500</span>)</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>    <span class="cf">else</span> y<span class="ot">=</span>(slope<span class="dv">-1</span><span class="sc">+</span><span class="fu">sqrt</span>((<span class="dv">1</span><span class="sc">-</span>slope)<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="dv">4</span><span class="sc">*</span>slope<span class="sc">*</span> <span class="fu">runif</span>(<span class="dv">500</span>)))<span class="sc">/</span><span class="dv">2</span><span class="sc">/</span>slope</span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="fu">gof_power_cont</span>(pnull, rnull, qnull, ralt, <span class="at">TS=</span>newTS_cont, <span class="at">param_alt=</span><span class="fu">round</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="at">length=</span><span class="dv">5</span>), <span class="dv">3</span>), <span class="at">Range=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a><span class="co">#&gt;       CvM alt</span></span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a><span class="co">#&gt; 0       0.049</span></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a><span class="co">#&gt; 0.125   0.337</span></span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a><span class="co">#&gt; 0.25    0.893</span></span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a><span class="co">#&gt; 0.375   0.998</span></span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a><span class="co">#&gt; 0.5     1.000</span></span></code></pre></div>
<p>for discrete data we write the routine using Rcpp:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;Rcpp.h&gt;</span></span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> Rcpp<span class="op">;</span></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a><span class="co">// [[Rcpp::export]]</span></span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>NumericVector newTS_disc<span class="op">(</span>IntegerVector x<span class="op">,</span> </span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>                      NumericVector Fx<span class="op">,</span></span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a>                      NumericMatrix nm<span class="op">,</span>  </span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>                      NumericVector vals<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>    </span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a>  Rcpp<span class="op">::</span>CharacterVector methods<span class="op">=</span>CharacterVector<span class="op">::</span>create<span class="op">(</span><span class="st">&quot;CvM alt&quot;</span><span class="op">);</span>    </span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a>  <span class="dt">int</span> <span class="at">const</span> nummethods<span class="op">=</span>methods<span class="op">.</span>size<span class="op">();</span></span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a>  <span class="dt">int</span> k<span class="op">=</span>x<span class="op">.</span>size<span class="op">(),</span> n<span class="op">,</span> i<span class="op">;</span></span>
<span id="cb35-12"><a href="#cb35-12" tabindex="-1"></a>  NumericVector TS<span class="op">(</span>nummethods<span class="op">),</span> ecdf<span class="op">(</span>k<span class="op">);</span></span>
<span id="cb35-13"><a href="#cb35-13" tabindex="-1"></a>  <span class="dt">double</span> tmp<span class="op">;</span></span>
<span id="cb35-14"><a href="#cb35-14" tabindex="-1"></a>  TS<span class="op">.</span>names<span class="op">()</span> <span class="op">=</span>  methods<span class="op">;</span></span>
<span id="cb35-15"><a href="#cb35-15" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" tabindex="-1"></a>  n<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb35-17"><a href="#cb35-17" tabindex="-1"></a>  <span class="cf">for</span><span class="op">(</span>i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>k<span class="op">;++</span>i<span class="op">)</span> n <span class="op">=</span> n <span class="op">+</span> x<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb35-18"><a href="#cb35-18" tabindex="-1"></a>  ecdf<span class="op">(</span><span class="dv">0</span><span class="op">)</span> <span class="op">=</span> <span class="dt">double</span><span class="op">(</span>x<span class="op">(</span><span class="dv">0</span><span class="op">))/</span><span class="dt">double</span><span class="op">(</span>n<span class="op">);</span>  </span>
<span id="cb35-19"><a href="#cb35-19" tabindex="-1"></a>  <span class="cf">for</span><span class="op">(</span>i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;</span>k<span class="op">;++</span>i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-20"><a href="#cb35-20" tabindex="-1"></a>    ecdf<span class="op">(</span>i<span class="op">)</span> <span class="op">=</span> ecdf<span class="op">(</span>i<span class="op">-</span><span class="dv">1</span><span class="op">)</span> <span class="op">+</span> x<span class="op">(</span>i<span class="op">)/</span><span class="dt">double</span><span class="op">(</span>n<span class="op">);</span></span>
<span id="cb35-21"><a href="#cb35-21" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb35-22"><a href="#cb35-22" tabindex="-1"></a></span>
<span id="cb35-23"><a href="#cb35-23" tabindex="-1"></a>  tmp <span class="op">=</span> <span class="bu">std::</span>abs<span class="op">(</span>ecdf<span class="op">[</span><span class="dv">0</span><span class="op">]-</span>Fx<span class="op">(</span><span class="dv">0</span><span class="op">))*</span>Fx<span class="op">(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb35-24"><a href="#cb35-24" tabindex="-1"></a>  <span class="cf">for</span><span class="op">(</span>i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;</span>k<span class="op">;++</span>i<span class="op">)</span> </span>
<span id="cb35-25"><a href="#cb35-25" tabindex="-1"></a>     tmp <span class="op">=</span> tmp <span class="op">+</span> <span class="bu">std::</span>abs<span class="op">(</span>ecdf<span class="op">(</span>i<span class="op">)-</span>Fx<span class="op">(</span>i<span class="op">))*(</span>Fx<span class="op">(</span>i<span class="op">)-</span>Fx<span class="op">(</span>i<span class="op">-</span><span class="dv">1</span><span class="op">));</span></span>
<span id="cb35-26"><a href="#cb35-26" tabindex="-1"></a>  TS<span class="op">(</span><span class="dv">0</span><span class="op">)</span> <span class="op">=</span> tmp<span class="op">;</span></span>
<span id="cb35-27"><a href="#cb35-27" tabindex="-1"></a> </span>
<span id="cb35-28"><a href="#cb35-28" tabindex="-1"></a>  <span class="cf">return</span> TS<span class="op">;</span></span>
<span id="cb35-29"><a href="#cb35-29" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Again the routine has to have four arguments x, Fx, nm and vals, just
like TS_disc, and the output vector has to have names. Aagin, the
arguments nm and vals are likely not needed for the calculation of the
new test statistic but need to be present for consistency reasons.</p>
<p>Note that one drawback of writing the routine in Rcpp is that it is
then not possible to used multiple processors.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>vals<span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">50</span><span class="sc">/</span><span class="dv">51</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>pnull <span class="ot">=</span> <span class="cf">function</span>() (<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>)<span class="sc">/</span><span class="dv">50</span></span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>rnull <span class="ot">=</span> <span class="cf">function</span>() <span class="fu">c</span>(<span class="fu">rmultinom</span>(<span class="dv">1</span>, <span class="dv">500</span>, <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">50</span>,<span class="dv">50</span>)))</span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnull</span>()</span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a><span class="fu">gof_test_disc</span>(x, pnull, rnull, vals, <span class="at">TS=</span>newTS_disc)</span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a><span class="co">#&gt; $Statistics</span></span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a><span class="co">#&gt; CvM alt </span></span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a><span class="co">#&gt;   0.013 </span></span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a><span class="co">#&gt; $p.value</span></span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a><span class="co">#&gt; CvM alt </span></span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a><span class="co">#&gt;  0.4648</span></span></code></pre></div>
<p>and for power calculations we can run</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a>ralt <span class="ot">=</span> <span class="cf">function</span>(slope) {</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>    <span class="cf">if</span>(slope<span class="sc">==</span><span class="dv">0</span>) p<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">50</span>, <span class="dv">50</span>)</span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>    <span class="cf">else</span> p<span class="ot">=</span><span class="fu">diff</span>(slope <span class="sc">*</span> (<span class="dv">0</span><span class="sc">:</span><span class="dv">50</span><span class="sc">/</span><span class="dv">50</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> slope) <span class="sc">*</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">50</span><span class="sc">/</span><span class="dv">50</span>)  </span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fu">rmultinom</span>(<span class="dv">1</span>, <span class="dv">500</span>, p))</span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>}</span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a><span class="fu">gof_power_disc</span>(pnull, rnull, vals, ralt, <span class="at">TS=</span>newTS_disc, <span class="at">param_alt=</span><span class="fu">round</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="at">length=</span><span class="dv">5</span>), <span class="dv">3</span>))</span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a><span class="co">#&gt; Parallel Programming is not possible if custom TS is written in C++. Switching to single processor</span></span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a><span class="co">#&gt;       CvM alt</span></span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a><span class="co">#&gt; 0       0.055</span></span>
<span id="cb37-10"><a href="#cb37-10" tabindex="-1"></a><span class="co">#&gt; 0.125   0.367</span></span>
<span id="cb37-11"><a href="#cb37-11" tabindex="-1"></a><span class="co">#&gt; 0.25    0.898</span></span>
<span id="cb37-12"><a href="#cb37-12" tabindex="-1"></a><span class="co">#&gt; 0.375   0.999</span></span>
<span id="cb37-13"><a href="#cb37-13" tabindex="-1"></a><span class="co">#&gt; 0.5     1.000</span></span></code></pre></div>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-anderson1962" class="csl-entry">
Anderson, T W. 1962. <span>“On the Distribution of the Two-Sample
<span>C</span>ramer-von <span> M</span>ises Criterion.”</span>
<em>Annals of Mathematical Statistics</em> 33 (3): 1148–59.
</div>
<div id="ref-anderson1952" class="csl-entry">
Anderson, T W, and D A Darling. 1952. <span>“Asymptotic Theory of
Certain Goodness-of-Fit Criteria Based on Stochastic Processes.”</span>
<em>Annals of Mathematical Statistics</em> 23: 193–212.
</div>
<div id="ref-anderson1954" class="csl-entry">
———. 1954. <span>“A Test of Goodness-of-Fit.”</span> <em>JASA</em> 49:
765–69.
</div>
<div id="ref-berkson1980" class="csl-entry">
Berkson, J. 1980. <span>“Minimum Chi-Square, Not Maximum
Likelihood.”</span> <em>Ann. Math. Stat</em> 8 (3): 457–87.
</div>
<div id="ref-wasserstein1999" class="csl-entry">
E del Barrio, C Matran, J A Cuesta-Albertos. 1999. <span>“Tests of
Goodness of Fit Based on the L2-Wasserstein Distance.”</span> <em>Annals
of Statistics</em> 1230-1239: 27.
</div>
<div id="ref-kolmogorov1933" class="csl-entry">
Kolmogorov, A. 1933. <span>“Sulla Determinazione Empirica Di Una Legge
Di Distribuzione.”</span> <em>G. Ist. Ital. Attuari.</em> 4: 83–91.
</div>
<div id="ref-kuiper1960" class="csl-entry">
Kuiper, N H. 1960. <span>“Tests Concerning Random Points on a
Circle.”</span> <em>Proceedings of the Koninklijke Nederlandse Akademie
van Wetenschappen</em> 63: 38–47.
</div>
<div id="ref-massey1951" class="csl-entry">
Massey, F J. 1951. <span>“The
<span>K</span>olmogorov-<span>S</span>mirnov Test for
Goodness-of-Fit.”</span> <em>JASA</em> 46: 68–78.
</div>
<div id="ref-rolke2020" class="csl-entry">
Rolke, Wolfgang, and Cristian Gutierrez-Gongora. 2020. <span>“A
Chi-Square Goodness-of-Fit Test for Continuous Distributions Against a
Known Alternative.”</span> <em>Computational Statistics</em>. <a href="https://doi.org/10.1007/s00180-020-00997-x">https://doi.org/10.1007/s00180-020-00997-x</a>.
</div>
<div id="ref-smirnov1948" class="csl-entry">
Smirnov, N. 1948. <span>“Table for Estimating the Goodness of Fit of
Empirical Distributions.”</span> <em>Annals of Mathematical
Statistics</em> 19: 279–81.
</div>
<div id="ref-zhang2002" class="csl-entry">
Zhang, J. 2002. <span>“Powerful Goodness-of-Fit Tests Based on
Likelihood Ratio.”</span> <em>Journal of the RSS (Series B)</em> 64:
281–94.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
